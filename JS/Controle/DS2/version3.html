<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Exo3</title>
    <script src="biblio.js"></script>

</head>
<body>

</body>
</html>
<script>
    class Releve {
        constructor(temp, node) {
            this.temp = temp;
            this.node = node;
        }

        display() {
            var table = '<table border="1">\n' +
                '        <thead>\n' +
                '            <tr style="background-color: #6d6f71">\n' +
                '                <th>Mois</th>\n' +
                '                <th>Minimum</th>\n' +
                '                <th>Maximum</th>\n' +
                '                <th>Moyenne</th>\n' +
                '            </tr>\n' +
                '        </thead>\n' +
                '        <tbody>';

            for (let i = 0; i < this.temp.length; i++) {
                let tr = "<tr class='" + i + "'><td>" + this.temp[i].mois + "</td><td>" + this.temp[i].tp.min() + "</td><td>" + this.temp[i].tp.max() + "</td><td>" + this.temp[i].tp.avg() + "</td></tr> "
                table += tr;
            }
            table += '</tbody>\n' +
                '    </table>';
            document.write(table);

    //         ESSAI SANS LA VARIABLE NB DANS LES FONCTIONS
    //                 this.lignes = document.getElementsByTagName('tr');
    //
    //                 for (let i = 1; i < this.lignes.length; i++) {
    //                     var that = this;
    //                     console.log(that);
    //                     this.lignes[i].onclick = () => {
    //                         var that = this;
    //                         that.fold();
    //                     }
    //                     this.lignes[i].onmouseover = () => {
    //                         var that = this;
    //                         that.color('#00ff00');
    //                     }
    //                     this.lignes[i].onmouseleave = () => {
    //                         var that = this;
    //                         that.color('#FFFFFF');
    //                     }
    //                 }
    //
    //                 console.log(this.lignes)
    //             }
    //             fold()
    //             {
    //                 console.log(this);
    //                 var ligne = document.getElementsByClassName(nb)[0];
    //                 for (let i = 0; i < this.temp[nb].tp.length; i++) {
    //                     ligne.innerHTML += '<td width="20px" style="text-align: center">' + this.temp[nb].tp[i] + '</td>';
    //                 }
    //                 ligne.onclick = () => {
    //                     this.unfold();
    //                 };
    //             }
    //             unfold()
    //             {
    //                 var ligne = document.getElementsByClassName(nb)[0];
    //                 ligne.innerHTML = "<tr class='" + nb + "'><td>" + this.temp[nb].mois + "</td><td>" + this.temp[nb].tp.min() + "</td><td>" + this.temp[nb].tp.max() + "</td><td>" + this.temp[nb].tp.avg() + "</td></tr> "
    //                 ligne.onclick = () => {
    //                     this.fold();
    //                 };
    //             }
    //             color(c)
    //             {
    //                 var ligne = document.getElementsByClassName(nb)[0];
    //                 ligne.style.backgroundColor = c;
    //             }
    //         }
            this.lignes = document.getElementsByTagName('tr');
            for (let i = 1; i < this.lignes.length; i++) {
                this.lignes[i].onclick=()=>{
                    this.fold(i-1);
                }
                this.lignes[i].onmouseover=()=>{
                    this.color(i-1,'#00ff00');
                }
                this.lignes[i].onmouseleave=()=>{
                    this.color(i-1,'#FFFFFF');
                }

            }

        }
        fold(nb){
            var ligne = document.getElementsByClassName(nb)[0];
            //console.log(this.lignes);
            //var nbLigne = this.ligne.className;
            //console.log(nbLigne);
            for (let i = 0; i < this.temp[nb].tp.length; i++) {
                ligne.innerHTML += '<td width="20px" style="text-align: center">'+this.temp[nb].tp[i]+'</td>';
            }
            ligne.onclick=()=>{this.unfold(nb);};
        }
        unfold(nb){
            var ligne = document.getElementsByClassName(nb)[0];
            ligne.innerHTML ="<tr class='"+nb+"'><td>" + this.temp[nb].mois + "</td><td>" + this.temp[nb].tp.min() + "</td><td>" + this.temp[nb].tp.max() + "</td><td>" + this.temp[nb].tp.avg() + "</td></tr> "
            ligne.onclick=()=>{this.fold(nb);};
        }
        color(nb, c){
            var ligne = document.getElementsByClassName(nb)[0];
            ligne.style.backgroundColor = c;
        }
    }


    let temp = [{"mois":"Janvier","tp":[2,1,5,2,10,-10,11,2,1,0,5,2,2,10,5,2,2,0,-2,1,2,0,5,-8,0,5,2,2,10,5,2]},
        {"mois":"Février","tp":[2,0,5,2,10,10,5,-2,-2,10,5,2,2,8,5,10,12,10,5,10,10,10,11,8,10,5,10,10]},
        {"mois":"Mars","tp":[2,1,5,1,12,10,5,1,12,10,5,1,2,10,1,1,12,10,15,12,12,10,15,12,10,15,12,12,10,15,12]},
        {"mois":"Avril","tp":[1,1,5,1,10,10,9,12,9,10,9,12,2,10,15,12,12,10,15,12,12,10,15,12,10,15,12,12,10,15]},
        {"mois":"Mai","tp":[12,10,15,12,12,10,15,12,12,10,15,12,12,10,15,12,12,10,15,12,12,10,15,12,10,15,12,12,10,15,12]},
        {"mois":"Juin","tp":[12,10,25,12,22,20,15,12,12,10,15,12,12,10,25,12,22,20,25,12,22,22,15,12,10,15,12,12,10,15]},
        {"mois":"Juillet","tp":[22,30,25,22,22,30,25,22,22,30,35,32,32,30,25,22,22,30,25,22,22,30,25,22,30,25,32,32,20,25,22]},
        {"mois":"Aout","tp":[23,31,26,23,23,29,24,21,21,31,31,30,30,30,24,22,23,30,28,22,22,30,28,22,31,25,30,28,20,28,22]},
        {"mois":"Septembre","tp":[22,30,25,22,22,30,25,22,22,30,35,32,32,30,25,22,22,30,25,22,22,30,25,22,30,25,32,32,20,25]},
        {"mois":"Octobre","tp":[12,10,15,12,12,10,15,12,12,10,15,12,12,10,15,12,12,10,15,12,12,10,15,12,10,15,12,12,10,15,12]},
        {"mois":"Novembre","tp":[12,10,15,12,12,10,15,12,12,10,15,12,12,10,15,12,12,10,15,12,12,10,15,12,10,15,12,12,10,15]},
        {"mois":"Décembre","tp":[12,10,12,10,12,10,12,10,10,8,12,8,12,8,9,13,12,13,14,12,10,8,10,9,10,9,8,9,10,8,12]}
    ];

    var body = document.getElementsByTagName('body');

    var relev = new Releve(temp,body);
    relev.display();

</script>